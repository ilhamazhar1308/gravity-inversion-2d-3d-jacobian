# Gravity Anomaly Modeling and Density Inversion (2D & 3D)
**Jacobian-Based Nonlinear Inversion**

---

## Repository Description
This repository contains MATLAB scripts for 2D and 3D gravity anomaly modeling and nonlinear inversion using a **linearized Jacobian matrix approach**.

The main goal is to **estimate subsurface density (rho)** from synthetic gravity anomaly data generated by a spherical subsurface model.

**Applications:**
- Gravity inversion learning
- Geophysical modeling
- Academic and educational purposes

---

## Repository Structure
```
├── gravity_inversion_2D_3D.m # Full 2D and 3D gravity modeling and inversion
├── density_inversion_rho.m # Density-only inversion script
└── README.md # This file
```
---

## Physical Model
**Subsurface body:**
- Geometry: Sphere
- Radius: `R` (meters)
- Density: `rho` (kg/m³)

**Gravity anomaly equation:**
```
g = G * (4/3 * pi * R^3 * rho) * z / r^3
```
Where:
- `G` = gravitational constant (6.67×10^-11)
- `z` = depth to the sphere center
- `r` = distance from observation point to sphere center

---

## Inversion Method
Nonlinear inversion is solved iteratively using **Jacobian matrix linearization**:
```
dG = J * dM
```

Where:
- `dG` = data misfit
- `J`  = Jacobian matrix
- `dM` = model update

**Damped least-squares solution:**
```
dM = inv(J' * J + lambda * I) * J' * dG
```
---

## Jacobian Matrix
**2D Model Parameters:**
M_2D = [x0, z0, rho]
J_2D = [∂g/∂x0 ∂g/∂z0 ∂g/∂rho]

**3D Model Parameters:**
M_3D = [x0, y0, z0]
J_3D = [∂g/∂x0 ∂g/∂y0 ∂g/∂z0]



---

## Requirements
- MATLAB R2018a or newer
- No additional toolboxes required

---

## How to Use (Bash / CMD)
1. **Clone repository**
```
git clone https://github.com/your-username/gravity-inversion-jacobian.git
cd gravity-inversion-jacobian
```
2. Open MATLAB from terminal (optional)
```
# Windows
matlab

# Linux / macOS
matlab
```
3. Run full 2D & 3D inversion
```
gravity_inversion_2D_3D
```
4. Run density-only inversion
```
density_inversion_rho
```

## Outputs
- 2D gravity anomaly curves

- 3D gravity anomaly surfaces

- Subsurface sphere visualization

- Misfit convergence plots

- Estimated density value (rho)

## Notes
- Data used are synthetic

- Results depend on initial model guess

- Regularization improves inversion stability

- Not intended for operational field interpretation

## Author
Ilham Azhar, Indra Saputra, Geraldy Purba, Yarra Rizky, Paula

Geophysical Engineering

Institute Technology of Sumatera (ITERA)

## Disclaimer
This program was developed as a final project for an academic course. It has undergone testing and supervision by the course instructor and can be used for educational purposes.
Note: Further development, validation, and expert review are required before using it in professional or operational applications.

## License
This repository is intended for academic and educational use. Please cite appropriately if used in publications.
